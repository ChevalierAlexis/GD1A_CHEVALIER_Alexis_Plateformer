<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" /><title>Station Spatiale</title>
<script
src="phaser.min.js"></script>
<style type="text/css"> body { margin: 0; }</style>
</head>
<body>
    <script type="text/javascript">
// class Bullet extends Phaser.Physics.Arcade.Sprite
// {
//     constructor (scene, x, y)
//     {
//         super(scene.physics.world,scene, x, y, 'bullet');
//         this.incX = 0;
//         this.incY = 0;
//         this.lifespan = 0;
//         this.ship;
//         this.speed = Phaser.Math.GetSpeed(600, 1);
       
//     }
    

//     fire (x, y)
//     {
//         this.body.reset(x, y);

//         this.setActive(true);
//         this.setVisible(true);
//         scene.physics.moveToObject(this.bullet, this.ennemi, 200);
//             // var angle = Phaser.Math.Angle.Between(x, y, this.ship.x, this.ship.y);

//             // this.setRotation(angle);

//             // this.incX = Math.cos(angle);
//             // this.incY = Math.sin(angle);

//             this.lifespan = 1000;
//     }
// }

// //     preUpdate (time, delta)
// //     {
// //         super.preUpdate(time, delta);

// //         if (this.y <= -32)
// //         {
// //             this.setActive(false);
// //             this.setVisible(false);
// //         }
// //     }
// // }

// class Bullets extends Phaser.Physics.Arcade.Group
// {
//     constructor (scene)
//     {
//         super(scene.physics.world, scene);
//         this.ship;
//         this.createMultiple({
//             frameQuantity: 5,
//             key: 'bullet',
//             active: false,
//             visible: false,
//             classType: Bullet
//         });
//     }

//     fireBullet (x, y)
//     {
//         let bullet = this.getFirstDead(false);

//         if (bullet)
//         {
//             bullet.fire(x, y);
//         }
//     }
//     update (time, delta)
//         {
//             this.lifespan -= delta;

//             // this.x -= this.incX * (this.speed * delta);
//             // this.y -= this.incY * (this.speed * delta);

//             if (this.lifespan <= 0)
//             {
//                 this.setActive(false);
//                 this.setVisible(false);
//             }
//         }

// }

class Example extends Phaser.Scene
{
    constructor ()
    {
        super();

        this.bullets;
        this.ship;
    }
    

    preload ()
    {
        this.load.image('bullet', 'assets/bullet.png');
        this.load.image('ship', 'assets/Chad.png');
        this.load.image('troll', 'assets/troll.png')
    }

    create ()
    {
        var bullets;
        var speed;
        var stats;
        var lastFired = 0;
        var isDown = false;
        var mouseX = 0;
        var mouseY = 0;

        // this.bullets = new Bullets(this);

        this.ship = this.add.image(400, 500, 'ship');
        this.ennemi = this.add.image(200,200,'troll');

        this.tir = this.physics.add.group();
        this.tir = this.physics.add.sprite(this.ennemi.x,this.ennemi.y, 'bullet');
        this.physics.moveToObject(this.tir, this.ship,200)

        this.input.on('pointermove', (pointer) => {

            this.ship.x = pointer.x;

        });

        this.input.on('pointerdown', (pointer) => {

            // this.bullets.fireBullet(this.ship.x, this.ship.y);

        });
        
    }

    update ()
    {
        
    //     if (this.isDown && time > lastFired)
    // {
    //     var bullet = bullets.get();

    //     if (bullet) 
    //     {
    //         bullet.fire(this.ennemi.x, this.ennemi.y);

    //         lastFired = time + 50;
    //     }
    // }
    }
}

const config = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    parent: 'phaser-example',
    physics: {
        default: 'arcade',
        arcade: {
            debug: false,
            gravity: { y: 0 }
            
        }
    },
    scene: Example
};

let game = new Phaser.Game(config);

</script>
</body>
</html>

//